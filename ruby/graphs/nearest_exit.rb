# https://leetcode.com/problems/nearest-exit-from-entrance-in-maze/

# @param {Character[][]} maze
# @param {Integer[]} entrance
# @return {Integer}
def nearest_exit(maze, entrance)
  height = maze.size
  width = maze[0].size
  dirs = { d: [1, 0], u: [-1, 0], r: [0, 1],  l: [0, -1]}
  distances = { entrance => 0 }
  queue = [entrance]

  while queue.any?
    current = queue.shift
    dist = distances[current]
    dirs.each do |_, dir|
      pos = [current[0] + dir[0], current[1] + dir[1]]
      if valid_pos?(pos, distances, maze, width, height)
        distances[pos] = dist + 1
        if exit?(pos, entrance, width, height)
          return distances[pos]
        end
        queue << pos
      end
    end
  end
  -1
end

def valid_pos?(pos, distances, maze, width, height)
  !distances[pos] &&
  pos[0] >= 0 && pos[0] < height &&
  pos[1] >= 0 && pos[1] < width &&
  maze[pos[0]][pos[1]] == '.'
end

# its on border and is not the entrance
def exit?(pos, entrance, width, height)
  (
    [0, height - 1].include?(pos[0]) ||
    [0, width - 1].include?(pos[1])
  ) && pos != entrance
end

maze = [
  ["+","+",".","+"],
  [".",".",".","+"],
  ["+","+","+","."]]
entrance = [1,2]
p nearest_exit(maze, entrance)

# maze = [["+","+","+"],[".",".","."],["+","+","+"]]
# entrance = [1,0]
# p nearest_exit(maze, entrance)

# maze = [[".","+"]]
# entrance = [0,0]
# p nearest_exit(maze, entrance)

# maze = [[".","+",".","+","+",".",".","+",".",".",".",".",".","+","+","+",".","+",".",".",".",".",".",".",".",".",".","+","+",".",".","+",".",".",".",".",".",".",".",".",".","+"],["+",".",".",".","+",".",".",".","+",".","+",".","+",".",".","+",".","+",".",".","+",".",".","+",".",".","+",".",".","+",".","+",".",".",".",".",".",".","+","+","+","."],[".",".",".","+",".","+",".",".","+",".",".","+",".",".",".","+",".",".",".",".",".",".",".",".",".",".",".","+",".","+",".",".",".",".",".",".",".",".","+",".",".","+"],[".",".",".","+","+","+",".",".",".","+",".","+",".",".",".",".","+","+",".","+",".","+",".",".",".",".",".",".","+","+",".",".",".","+",".",".",".","+","+",".","+","."],[".",".",".",".","+",".",".",".",".","+",".",".",".",".",".",".",".","+","+",".",".",".","+",".",".","+",".",".","+",".",".",".",".",".",".","+",".","+",".",".",".","+"],[".",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".","+",".",".",".","+",".","+","+",".",".",".",".",".",".","+",".","+",".",".",".",".",".",".","."],[".",".","+",".","+",".","+",".","+","+",".",".",".",".","+",".",".","+","+","+",".",".",".","+","+","+","+",".","+",".",".",".",".",".",".",".",".",".",".",".",".","."],[".",".","+",".",".","+",".",".","+",".",".","+","+","+","+",".",".","+",".",".","+","+",".",".",".",".",".",".",".","+",".",".","+",".",".","+",".",".",".",".",".","."],["+",".",".",".",".",".","+",".","+",".","+",".","+",".","+",".","+","+",".",".",".",".","+",".",".","+","+",".",".","+",".",".",".","+",".","+","+",".",".",".","+","."],[".",".",".",".",".",".",".",".",".","+",".",".",".",".","+",".",".",".","+",".","+",".",".",".",".","+","+",".",".","+",".",".",".","+","+",".",".",".",".",".",".","."],[".",".","+",".",".",".","+",".",".","+",".",".","+",".","+",".",".",".",".",".",".","+",".",".",".","+",".","+","+","+",".",".",".","+",".",".",".",".",".",".","+","+"],[".","+",".",".",".","+",".",".",".",".","+",".",".",".","+","+",".",".",".",".",".",".","+",".",".",".","+",".",".","+","+","+","+",".","+","+",".",".",".",".",".","+"],["+","+","+","+",".",".","+",".",".","+",".",".",".","+",".","+","+",".","+","+","+",".",".",".",".",".","+",".",".","+",".",".",".",".",".",".",".",".","+","+",".","."],[".",".",".",".",".","+",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".",".","+","+","+",".",".","+",".",".",".","+",".",".",".","+","+",".","+","+","."],[".",".",".",".",".","+",".",".",".",".",".",".","+","+",".","+",".","+","+","+",".",".","+",".","+",".",".",".",".",".",".","+",".",".","+",".",".",".",".",".",".","+"],[".",".",".",".",".","+",".",".","+",".",".",".",".","+",".",".",".",".",".",".",".",".",".","+",".",".","+",".",".","+","+",".",".","+","+",".",".",".",".","+",".","."],[".",".",".",".","+",".","+",".",".",".","+",".",".",".","+",".",".",".","+",".",".",".",".",".",".",".",".",".","+",".",".","+",".",".",".",".",".",".",".",".",".","."],["+","+",".",".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".","+","+",".",".",".",".",".","+",".","+",".",".",".","+","+",".",".","+","+","+"],[".",".","+",".","+","+","+",".",".",".",".",".","+","+","+","+","+",".","+",".",".","+",".",".","+",".",".",".",".",".",".",".","+",".","+",".",".","+","+",".","+","."],[".","+","+",".","+",".",".","+",".",".","+",".","+",".",".","+",".",".","+","+","+",".","+",".",".",".","+",".",".",".",".",".",".","+",".","+","+","+",".","+",".","."],["+",".",".","+",".",".",".",".",".","+",".","+",".","+",".",".",".",".",".",".",".",".","+",".","+","+",".",".","+",".",".","+",".",".",".",".","+","+",".",".",".","+"],["+",".",".",".",".",".",".",".","+","+",".",".",".",".","+","+","+","+","+","+","+","+","+",".",".",".",".",".","+",".",".",".",".",".",".",".","+","+",".",".",".","."],[".","+",".",".",".",".",".","+",".",".","+","+",".",".",".",".",".",".",".","+","+",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".",".",".",".",".","+","."],[".",".",".","+","+",".",".","+",".",".",".",".","+",".",".","+",".","+","+","+","+",".","+","+",".",".",".","+","+",".","+",".",".",".",".",".","+","+",".","+","+","."],[".",".",".","+",".",".","+",".",".","+",".",".",".",".",".",".",".","+",".",".",".","+","+",".",".","+",".",".","+",".","+","+",".",".",".",".","+","+","+","+","+","."],["+",".",".",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".","+",".",".",".","+","+",".","+",".","+",".",".",".","+","+",".","+","+","+",".",".",".","+","+"],["+",".",".",".","+","+",".",".",".","+",".","+",".",".",".","+","+",".",".","+",".",".",".",".",".",".","+",".",".",".","+","+","+",".",".",".",".","+",".",".",".","."],[".","+",".",".",".",".",".","+","+",".",".","+",".","+",".",".",".",".",".",".",".",".","+","+",".",".","+",".",".",".",".",".",".","+","+","+",".","+",".",".","+","+"],[".",".",".",".",".","+",".",".",".",".","+","+","+",".","+",".",".","+",".",".",".","+","+",".","+","+",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".","+"],[".","+",".",".","+",".",".","+",".",".",".",".",".",".","+",".","+","+",".","+",".",".",".","+","+",".","+",".",".",".",".",".",".","+",".","+","+",".",".",".",".","."],[".",".",".",".",".","+",".",".","+",".",".","+","+",".","+",".",".","+",".",".",".",".",".","+",".",".","+",".",".","+","+",".",".",".",".",".",".",".",".",".",".","."],["+","+",".",".","+",".","+",".",".",".",".","+",".",".","+",".",".",".",".",".",".",".","+",".","+",".","+","+","+","+",".","+",".","+","+",".","+",".","+",".","+","."],["+",".",".","+",".","+",".",".",".",".",".",".",".","+","+",".",".","+","+",".",".",".",".","+",".",".","+",".",".",".",".","+",".",".","+",".","+",".",".","+",".","+"],["+",".",".",".",".",".","+","+",".","+",".",".",".",".",".","+",".",".",".",".",".","+","+",".",".",".",".",".",".","+",".","+","+",".",".",".","+","+",".",".",".","."],[".",".","+",".",".","+","+",".","+","+",".",".",".",".",".",".",".",".",".",".",".",".",".",".",".","+",".","+","+","+",".",".",".","+",".",".","+",".",".",".",".","+"],[".",".","+",".",".",".",".",".","+",".","+","+","+",".",".","+",".",".",".",".",".",".",".",".","+",".",".","+",".","+",".","+",".",".",".","+",".",".",".",".","+","."],[".",".",".","+",".","+",".","+",".","+",".",".","+","+","+","+",".",".",".","+",".","+","+","+","+","+",".",".",".","+",".",".",".",".","+","+",".",".",".",".","+","."],[".",".",".","+",".","+",".",".",".","+",".",".","+","+",".",".","+",".",".","+",".",".",".",".","+",".","+",".","+",".",".",".",".",".","+","+",".",".","+",".","+","+"],["+",".","+",".",".",".","+",".","+",".","+",".",".",".",".","+",".","+",".",".",".","+",".",".",".",".","+",".","+",".",".",".",".",".",".",".",".",".",".",".",".","+"],["+",".",".",".","+",".",".",".",".",".","+","+","+",".",".",".","+",".","+","+",".","+",".",".","+",".","+","+",".",".",".",".",".",".",".","+",".","+",".",".",".","."],["+",".",".",".",".",".",".",".","+",".",".",".","+","+",".","+",".",".",".",".",".","+",".",".","+",".",".",".",".",".",".","+",".",".",".",".",".",".",".",".",".","."],[".",".","+","+",".",".",".",".",".",".",".","+","+",".",".","+",".","+",".","+",".",".",".","+",".","+",".",".","+",".",".",".",".","+",".",".",".","+",".",".","+","."],[".",".",".","+","+",".",".",".",".","+",".","+",".",".",".",".",".",".",".",".",".",".","+",".",".",".",".",".",".",".","+",".",".",".","+",".",".",".",".","+",".","."],[".",".",".","+",".",".",".",".",".",".",".",".","+","+",".","+",".",".",".",".","+",".","+",".",".",".",".",".","+","+","+","+",".","+","+",".",".",".",".",".",".","."],["+",".",".",".",".",".",".","+",".",".",".",".","+",".","+",".",".",".",".","+",".","+",".",".",".","+","+",".",".","+",".",".",".","+",".",".",".","+",".",".","+","+"],[".",".","+",".","+","+","+",".",".",".",".",".",".",".",".",".","+","+",".",".",".",".",".","+","+",".","+",".","+",".",".",".",".",".",".",".",".",".",".","+",".","."],[".","+","+",".","+",".",".",".",".",".",".",".",".","+",".","+","+",".",".",".",".",".","+",".","+",".",".","+","+",".",".",".","+","+","+",".",".",".",".",".",".","+"],[".","+",".","+","+",".","+",".",".","+","+","+",".","+",".","+",".",".",".","+","+","+",".",".","+",".",".","+",".","+",".",".","+",".","+",".","+","+",".",".","+","."],[".",".",".","+",".","+","+",".",".",".",".",".",".",".",".","+",".",".","+","+","+",".",".","+",".",".",".",".",".",".","+",".","+",".","+",".",".",".",".",".",".","."]]
# entrance = [48,41]
# p nearest_exit(maze, entrance)

maze = [
  %w[. + + + . . . + +],
  %w[. . + . + . + + .],
  %w[. . + . . . . . .],
  %w[. + . . + + . + .],
  %w[. . . . . . . + .],
  %w[. . . . . . . . .],
  %w[. . . + . . . . .],
  %w[. . . . . . . . +],
  %w[+ . . . + . . . .]]
entrance = [5,6]
p nearest_exit(maze, entrance)
